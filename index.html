<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <canvas width="800" height="600" id="mycanvas"></canvas>
    <input type="file" id="file" disabled>

    <script src="https://nodebox.live/api/v1/ndbx.js"></script>
    <script>
        const options = {
            userId: 'harterink',
            projectId: 'bla',
            canvasId: 'mycanvas',
            autoplay: true
        };

        ndbx.embed(options, function (err, player) {
            window.player = player; // Make the player object global.
            document.querySelector('#file').removeAttribute('disabled');
        });

        window.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowRight') {
                loadImageWithUrl("https://codespacehelp.s3.amazonaws.com/students/bobharterink/photo-1709678144287-6e3af13b8c6c.jpeg");
            }
        })

        async function loadImageWithUrl(url) {
            const res = await fetch(url, {
                mode: 'cors'
            });
            const blob = await res.blob();
            const blobUrl = URL.createObjectURL(blob);
            const image = new Image();
            image.onload = function () {


                // const canvas = document.createElement('canvas');
                // const ctx = canvas.getContext('2d');
                // canvas.width = img.width;
                // canvas.height = img.height;
                // ctx.drawImage(img, 0, 0);
                // document.appendChild(canvas);
                ndbx.assets[url] = image;
                player.setValue('getPixels2', 'imageName', url);
                URL.revokeObjectURL(blobUrl);
            }


            // };
            image.src = blobUrl;
            // 
        }

        // document.querySelector('#file').addEventListener('change', function (e) {
        //     var file = e.target.files[0];
        //     console.log(file);
        //     var reader = new FileReader();
        //     reader.onload = function (e) {
        //         var data = e.target.result;
        //         const image = new Image();
        //         image.src = data;
        //         image.onload = function () {
        //             ndbx.assets[file.name] = image;
        //             player.setValue('getPixels2', 'imageName', file.name);
        //         }
        //     }
        //     reader.readAsDataURL(file);
        // });
    </script>
</body>

</html>